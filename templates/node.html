{% extends "base.html" %}

{% block title %}
<title>{{ node.node_name | title }} - {{ node.domain_token | title }}</title>
{% endblock title %}

{% block content %}
    <div class="col-md m-md-2 m-1">
        <br>
        <h1>{{ node.node_name | title }} - {{ node.domain_token | title }}</h1>
        <p><a href="/full_person_graph">View full graph</a> | <a href="/full_node_graph">View global graph</a> | <a href="/">Return to Index</a></p>
        <p><a href="/node_graph/{{ node.slug }}">View graph for {{ node.node_name }}</a></p>

        <hr>
        <p>The table below shows the data from this specific node.</p>
        <button class="btn btn-info" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
            Explanation of results
        </button>
        <div class="collapse" id="collapseExample">
            <div class="card card-body">
            <p>The lenses of all lived experiences entered as part of the survey have been combined into a graph - a networked representation of connections across many people.</p>
            <p>Below, you will see the results for the experience you selected, called a node.</p>
            <p>Further below, or in the next column depending on your device, you will see the results for all of the other experiences that are connected with the one you selected.
                As more peole complete the survey, this insight will deepen.</p>
            <p>Here are what the results mean:</p>
            <ul>
                <li><strong>experience</strong> - the name of the lived experience</li>
                <li><strong>Domain</strong> - whether the experience is a part of the person or a part of the system of work</li>
                <li><strong>Instances</strong> - how many times this experience has been entered in the survey. If the result is "1", then you are the first person to do so</li>
                <li><strong>Mean Inclusivity</strong> - the average inclusivity rating for the experience from -1.00 to +1.00.</li>
            </ul>
            <p>The next chart is a frequency distribution of the responses to the statement: "Though this experience, in the workplace, I feel..."</p>
            <ul>
                <li><strong>Statement</strong> - the explanation of how the experience effected the person</li>
                <li><strong>Count</strong> - the number of times people recorded this explanation</li>
            </ul>
        </div>
        </div>
        <p>[[ ADD STATISTICS HERE ]]</p>

        <table>
            <tr>
                <th style="text-align: center;">Experience</th>
                <th style="text-align: center;">Domain</th>
                <th style="text-align: center;">Instances</th>
                <th style="text-align: center;">Mean Inclusivity</th>
            </tr>
            <tr>
                <td style="text-align: center;">{{ node_lens.name | title }}</td>
                <td style="text-align: center;">{{ node_lens.domain | title }}</td>
                <td style="text-align: center;">{{ node_lens.count }}</td>
                <td style="text-align: center;">
                    {{ node_lens.mean_inclusivity | round(method="ceil", precision=3) }}
                    {% if node_lens.mean_inclusivity | float > 0.2 %}
                        <span style="color: green; font-size: 2em;">＋</span>
                    {% elif node_lens.mean_inclusivity | float < -0.2 %}
                        <span style="color: red; font-size: 2em;">－</span>
                    {% else %}
                        <span style="color: blue; font-size: 1.5em;"><></span>
                    {% endif %}
                </td>
            </tr>
        </table>

        <br>

        <table>
            <tr>
                <th style="text-align: center;">Statement</th>
                <th style="text-align: center;">Count</th>
            </tr>
            {% for tuple in node_lens.frequency_distribution %}
                <tr>
                    <td>{{ tuple.0 }}</td>
                    <td style="text-align: center;">{{ tuple.1 }}</td>
                </tr>
            {% endfor %}
        </table>

    </div>

    <div class="col-md m-md-2 m-1">
        <br>
        <h1>Associated Experiences</h1>
        <p>These are experiences from other nodes that have been linked to the {{ node.domain_token }} trait of {{ node.node_name }}. 
            They are presented here to show how the nodes relate and how by looking at more than one facet of a person's experience, 
            we can better understand our people's needs.</p>
        <hr>
                {% for lens in other_lenses %}
                    <table>
                        <tr>
                            <th style="text-align: center;">Experience</th>
                            <th style="text-align: center;">Domain</th>
                            <th style="text-align: center;">Instances</th>
                            <th style="text-align: center;">Mean Inclusivity</th>
                        </tr>
                        <tr>
                            <td style="text-align: center;"><a href="/node/{{ lens.name | snake_case }}">{{ lens.name | title }}</a></td>
                            <td style="text-align: center;">{{ lens.domain | title }}</td>
                            <td style="text-align: center;">{{ lens.count }}</td>
                            <td style="text-align: center;">
                                {{ lens.mean_inclusivity | round(method="ceil", precision=3) }}
                                {% if lens.mean_inclusivity | float > 0.2 %}
                                    <span style="color: green; font-size: 2em;">＋</span>
                                {% elif lens.mean_inclusivity | float < -0.2 %}
                                    <span style="color: red; font-size: 2em;">－</span>
                                {% else %}
                                    <span style="color: blue; font-size: 1.5em;"><></span>
                                {% endif %}
                            </td>
                        </tr>
                    </table>

                    <br>

                    <table>
                        <tr>
                            <th style="text-align: center;">Statement</th>
                            <th style="text-align: center;">Count</th>
                        </tr>
                        {% for tuple in lens.frequency_distribution %}
                            <tr>
                                <td>{{ tuple.0 }}</td>
                                <td style="text-align: center;">{{ tuple.1 }}</td>
                            </tr>
                        {% endfor %}
                    </table>

                    <hr>
                    <br>
                {% endfor %}
    </div>
{% endblock content %}